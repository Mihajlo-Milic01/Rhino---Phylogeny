n = 10
# Then we need some true mean distance
mu_true = 1
# Simulate the observed mean distance of the arrows we shot
arrow_mean = rgamma(1, n, n/mu_true)[1]
n
alpha <- 1 
mu ~ dnExponential(alpha)
mu
moves[1] = mvSlide(mu, delta = 1, weight = 1.)
moves
moves[1]
d_bar ~ dnGamma(n, n/mu)
d_bar.clamp(arrow_mean)
# Construct the full model
my_model = model(mu)
monitors[1] = mnModel(filename="archery_RB.log", printgen=10)
monitors[2] = mnScreen(printgen=1000, mu)
analysis = mcmc(my_model, monitors, moves)
analysis.run(10000)
analysis.operatorSummary()
source("scripts/mcmc_JC.Rev")
source("C:\\RevBayes\\Tutorials\\substitution_models\\scripts\\mcmc_JC.Rev")
source("C:\\\\RevBayes\\\\Tutorials\\\\substitution_models\\\\scripts\\\\mcmc_JC.Rev")
getwd()
setwd("C:\\RevBayes\\Tutorials\\substitution_models")
setwd("C:\\\\RevBayes\\\\Tutorials\\\\substitution_models")
getwd()
setwd(C:\\RevBayes\\Tutorials\\substitution_models)
C:\\RevBayes\\Tutorials\\substitution_models
setwd("C:\\\\RevBayes\\\\Tutorials\\\\substitution_models")
setwd("C:\\\\RevBayes\\\\Tutorials\\\\partitioning")
getwd()
setwd("C:\\\\RevBayes\\\\Rhinos")
filenames <- v("data\\\\rrna.nex", "data\\\\coding_1.nex", "data\\\\coding_2.nex", "data\\\\coding_3.nex")
n_data_sets <- filenames.size()
n_data_sets
getwd()
setwd("C:\\\\RevBayes\\\\Rhinos")
getwd()
setwd("C:\\\\RevBayes\\\\Rhinos")
setwd("C:\\RevBayes\\Rhinos")
setwd("C:\\\\RevBayes\\\\Rhinos")
setwd("C:\\\\RevBayes\\\\Tutorials\\\\FBD_bears")
aa <-readDiscreteCharacterData("C:\\\\Users\\\\Mihajlo\\Documents\\\\Bavarska\\\\Rhino\\\\data\\\\my_matrix\\\\mesquite_export\\\\finalizing_matrix_v2_RB.nex")
aa <-readDiscreteCharacterData("C:\\\\Users\\\\Mihajlo\\\\Documents\\\\Bavarska\\\\Rhino\\\\data\\\\my_matrix\\\\mesquite_export\\\\finalizing_matrix_v2_RB.nex")
aaa
aa
taxa <- readTaxonData("C:\\\\Users\\\\Mihajlo\\\\Documents\\\\Bavarska\\\\Rhino\\\\Rhino_github\\\\data\\\\stratigraphical_ranges.tsv")
taxa
taxa[,2]
taxa[2]
taxa[1
]
clear()
setwd("C:\\\\Users\\\\Mihajlo\\\\Documents\\\\Bavarska\\\\Rhino\\\\Rhino_github")
?dnFBDP
?dnConstrainedTopology
clear()
source("C:\\Users\\Mihajlo\\Documents\\Bavarska\\Rhino\\Rhino_github\\scripts\\mcmc_CEFBDRP_Ranges_rhinos.Rev")
source("C:\\\\Users\\\\Mihajlo\\\\Documents\\\\Bavarska\\\\Rhino\\\\Rhino_github\\\\scripts\\\\mcmc_CEFBDRP_Ranges_rhinos.Rev")
source("scripts/mcmc_CEFBDRP_Ranges.Rev")
setwd("C:\\\\Users\\\\Mihajlo\\\\Documents\\\\Bavarska\\\\Rhino\\\\Rhino_github")
speciation_rate ~ dnExponential(10)
extinction_rate ~ dnExponential(10)
moves.append( mvScale(speciation_rate, lambda=0.01, weight=1) )
moves.append( mvScale(speciation_rate, lambda=0.1,  weight=1) )
moves.append( mvScale(speciation_rate, lambda=1.0,  weight=1) )
moves.append( mvScale(extinction_rate, lambda=0.01, weight=1) )
moves.append( mvScale(extinction_rate, lambda=0.1,  weight=1) )
moves.append( mvScale(extinction_rate, lambda=1,    weight=1) )
diversification := speciation_rate - extinction_rate
turnover := extinction_rate/speciation_rate
rho <- 1.0 #probability of sampling extant taxa (all living rhino species are present in the character matix)
psi ~ dnExponential(10) # fosill recovery (sampling) rate 
moves.append( mvScale(psi, lambda=0.01, weight=1) )
moves.append( mvScale(psi, lambda=0.1,  weight=1) )
moves.append( mvScale(psi, lambda=1,    weight=1) )
origin_time ~ dnUnif(55.0, 64.0) # Divergence of Rhinocerotoidea and lineage leading to modern Tapiridae; based on Liu et al 2021 and Bai et al 2020
moves.append( mvSlide(origin_time, delta=0.01, weight=5.0) )
moves.append( mvSlide(origin_time, delta=0.1,  weight=5.0) )
moves.append( mvSlide(origin_time, delta=1,    weight=5.0) )
fbd_dist = dnFBDP(originAge=origin_time, lambda=speciation_rate, mu=extinction_rate, psi=psi, rho=rho, taxa=taxa)
## might use the different function for our FBD model
### potential clade constraints for our dataset ###
##fbd_tree ~ dnConstrainedTopology(fbd_dist, constraints=constraints)
moves.append( mvFNPR(fbd_tree, weight=15.0) )
moves.append( mvCollapseExpandFossilBranch(fbd_tree, origin_time, weight=6.0) ) # do we need this?
moves.append( mvNodeTimeSlideUniform(fbd_tree, weight=40.0) )
moves.append( mvRootTimeSlideUniform(fbd_tree, origin_time, weight=5.0) )
num_samp_anc := fbd_tree.numSampledAncestors()
#age_extant := tmrca(fbd_tree, clade_extant) # MRCA age of all extant bearas
clear()
setwd("C:\\\\Users\\\\Mihajlo\\\\Documents\\\\Bavarska\\\\Rhino\\\\Rhino_github")
taxa <- readTaxonData("../data/stratigraphical_ranges_rhinos.tsv")
taxa <- readTaxonData("data/stratigraphical_ranges_rhinos.tsv")
taxa
morpho <- readDiscreteCharacterData("data/finalizing_matrix_RB_rhinos.nex")
morpho <- readDiscreteCharacterData("data/character_matrix_RB_rhinos.nex")
morpho
